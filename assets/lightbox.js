(function(w,L){typeof exports=="object"&&typeof module!="undefined"?module.exports=L():typeof define=="function"&&define.amd?define(L):(w=w||self,w.Tobii=L())})(this,function(){"use strict";function w(L){var o={},E=window,k=0,d=null,c=null,f=null,p=null,b=null,u={},x=!1,S=!1,y=!1,R=null,N=null,H=null,D=null,q=null,X=!1,W=!1,Y=[],A=[],M=0,ve={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},r={},l=null,i=null,he=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M14 18l-6-6 6-6"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M10 6l6 6-6 6"/></svg>'],navLabel:["Previous image","Next image"],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6 6l12 12M6 18L18 6"/></svg>',closeLabel:"Close lightbox",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download image",keyboard:!0,zoom:!1,zoomText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M21 16v5h-5"/><path d="M8 21H3v-5"/><path d="M16 3h5v5"/><path d="M3 8V3h5"/></svg>',docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},h={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)(\?.*)?$/i)},init:function(e,t){var n=document.createElement("figure"),s=document.createElement("figcaption"),v=document.createElement("img"),g=e.querySelector("img"),P=document.createElement("div");n.style.opacity="0",g&&(v.alt=g.alt||""),v.setAttribute("src",""),v.setAttribute("data-src",e.href),n.appendChild(v),o.captions&&(o.captionsSelector==="self"&&e.getAttribute(o.captionAttribute)?s.textContent=e.getAttribute(o.captionAttribute):o.captionsSelector==="img"&&g&&g.getAttribute(o.captionAttribute)&&(s.textContent=g.getAttribute(o.captionAttribute)),s.textContent&&(s.id="tobii-figcaption-"+k,n.appendChild(s),v.setAttribute("aria-labelledby",s.id),++k)),t.appendChild(n),P.className="tobii-loader",P.setAttribute("role","progressbar"),P.setAttribute("aria-label",o.loadingIndicatorLabel),t.appendChild(P),t.setAttribute("data-type","image")},onPreload:function(e){h.image.onLoad(e)},onLoad:function(e){var t=e.querySelector("img");if(t.hasAttribute("data-src")){var n=e.querySelector("figure"),s=e.querySelector(".tobii-loader");t.onload=function(){e.removeChild(s),n.style.opacity="1"},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")}},onLeave:function(e){},onCleanup:function(e){}},html:{checkSupport:function(e){return V(e,"html")},init:function(e,t){var n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),s=document.querySelector(n);if(!s)throw new Error("Ups, I can't find the target "+n+".");t.appendChild(s),t.setAttribute("data-type","html")},onPreload:function(e){},onLoad:function(e){var t=e.querySelector("video");t&&(t.hasAttribute("data-time")&&t.readyState>0&&(t.currentTime=t.getAttribute("data-time")),o.autoplayVideo&&t.play())},onLeave:function(e){var t=e.querySelector("video");t&&(t.paused||t.pause(),t.readyState>0&&t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){var t=e.querySelector("video");if(t&&t.readyState>0&&t.readyState<3&&t.duration!==t.currentTime){var n=t.cloneNode(!0);Se(t),t.load(),t.parentNode.removeChild(t),e.appendChild(n)}}},iframe:{checkSupport:function(e){return V(e,"iframe")},init:function(e,t){var n=document.createElement("iframe"),s=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");n.setAttribute("frameborder","0"),n.setAttribute("src",""),n.setAttribute("data-src",s),e.getAttribute("data-width")&&(n.style.maxWidth=e.getAttribute("data-width")+"px"),e.getAttribute("data-height")&&(n.style.maxHeight=e.getAttribute("data-height")+"px"),t.appendChild(n),t.setAttribute("data-type","iframe")},onPreload:function(e){},onLoad:function(e){var t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(e){},onCleanup:function(e){}},youtube:{checkSupport:function(e){return V(e,"youtube")},init:function(e,t){var n=document.createElement("div");t.appendChild(n),A[M]=new window.YT.Player(n,{host:"https://www.youtube-nocookie.com",height:e.getAttribute("data-height")||"360",width:e.getAttribute("data-width")||"640",videoId:e.getAttribute("data-id"),playerVars:{controls:e.getAttribute("data-controls")||1,rel:0,playsinline:1}}),t.setAttribute("data-player",M),t.setAttribute("data-type","youtube"),M++},onPreload:function(e){},onLoad:function(e){o.autoplayVideo&&A[e.getAttribute("data-player")].playVideo()},onLeave:function(e){A[e.getAttribute("data-player")].getPlayerState()===1&&A[e.getAttribute("data-player")].pauseVideo()},onCleanup:function(e){A[e.getAttribute("data-player")].getPlayerState()===1&&A[e.getAttribute("data-player")].pauseVideo()}}};Object.entries||(Object.entries=function(a){for(var e=Object.keys(a),t=e.length,n=new Array(t);t--;)n[t]=[e[t],a[e[t]]];return n});var ge=function(e){o=he(e),d||be();var t=document.querySelectorAll(o.selector);if(!t)throw new Error("Ups, I can't find the selector "+o.selector+".");Array.prototype.forEach.call(t,function(n){J(n)})},J=function(e,t){if(document.querySelector('[data-type="youtube"]')!==null&&!W){if(document.getElementById("iframe_api")===null){var n=document.createElement("script"),s=document.getElementsByTagName("script")[0];n.id="iframe_api",n.src="https://www.youtube.com/iframe_api",s.parentNode.insertBefore(n,s)}Y.indexOf(e)===-1&&Y.push(e),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(Y,function(v){K(v,t)}),W=!0}}else K(e,t)},z=function(e){return e.hasAttribute("data-group")?e.getAttribute("data-group"):"default"},me=function(e){return JSON.parse(JSON.stringify(e))},K=function(e,t){if(l=z(e),Object.prototype.hasOwnProperty.call(r,l)||(r[l]=me(ve),ye()),r[l].gallery.indexOf(e)===-1){if(r[l].gallery.push(e),r[l].elementsLength++,o.zoom&&e.querySelector("img")){var n=document.createElement("div");n.className="tobii-zoom__icon",n.innerHTML=o.zoomText,e.classList.add("tobii-zoom"),e.appendChild(n)}e.addEventListener("click",ae),Ae(e),m()&&l===i&&(B(),I()),t&&t.call(this)}else throw new Error("Ups, element already added to the lightbox.")},$=function(e,t){var n=z(e);if(r[n].gallery.indexOf(e)!==-1){var s=r[n].gallery.indexOf(e),v=r[n].sliderElements[s];if(r[n].elementsLength--,o.zoom&&e.querySelector(".tobii-zoom__icon")){var g=e.querySelector(".tobii-zoom__icon");g.parentNode.classList.remove("tobii-zoom"),g.parentNode.removeChild(g)}e.removeEventListener("click",ae),v.parentNode.removeChild(v),m()&&n===i&&(B(),I()),t&&t.call(this)}},be=function(){d=document.createElement("div"),d.setAttribute("role","dialog"),d.setAttribute("aria-hidden","true"),d.className="tobii",c=document.createElement("button"),c.className="tobii__prev",c.setAttribute("type","button"),c.setAttribute("aria-label",o.navLabel[0]),c.innerHTML=o.navText[0],d.appendChild(c),f=document.createElement("button"),f.className="tobii__next",f.setAttribute("type","button"),f.setAttribute("aria-label",o.navLabel[1]),f.innerHTML=o.navText[1],d.appendChild(f),p=document.createElement("button"),p.className="tobii__close",p.setAttribute("type","button"),p.setAttribute("aria-label",o.closeLabel),p.innerHTML=o.closeText,d.appendChild(p),b=document.createElement("div"),b.className="tobii__counter",d.appendChild(b),document.body.appendChild(d)},ye=function(){r[l].slider=document.createElement("div"),r[l].slider.className="tobii__slider",d.appendChild(r[l].slider)},Ae=function(e){for(var t in h)if(Object.prototype.hasOwnProperty.call(h,t)&&h[t].checkSupport(e)){var n=document.createElement("div"),s=document.createElement("div");n.className="tobii__slider-slide lazyload",n.style.position="absolute",n.style.left=r[l].x*100+"%",h[t].init(e,s),n.appendChild(s),r[l].slider.appendChild(n),r[l].sliderElements.push(n),++r[l].x;break}},Q=function(e,t){if(console.log(e),i=i!==null?i:l,!m()&&!e&&(e=0),m()){if(!e)throw new Error("Ups, Tobii is aleady open.");if(e===r[i].currentIndex)throw new Error("Ups, slide "+e+" is already selected.")}if(e===-1||e>=r[i].elementsLength)throw new Error("Ups, I can't find slide "+e+".");o.hideScrollbar&&(document.documentElement.classList.add("tobii-is-open"),document.body.classList.add("tobii-is-open")),B(),o.close||(p.disabled=!1,p.setAttribute("aria-hidden","true")),R=document.activeElement,r[i].currentIndex=e,U(),Ee(),j(r[i].currentIndex),d.setAttribute("aria-hidden","false"),I(),_(r[i].currentIndex+1),_(r[i].currentIndex-1),setTimeout(function(){r[i].slider.classList.add("tobii__slider--animate")},1e3),t&&t.call(this)},C=function(e){if(!m())throw new Error("Tobii is already closed.");o.hideScrollbar&&(document.documentElement.classList.remove("tobii-is-open"),document.body.classList.remove("tobii-is-open")),xe(),R.focus();var t=r[i].sliderElements[r[i].currentIndex].querySelector("[data-type]"),n=t.getAttribute("data-type");h[n].onLeave(t),h[n].onCleanup(t),d.setAttribute("aria-hidden","true"),r[i].currentIndex=0,r[i].slider.classList.remove("tobii__slider--animate"),e&&e.call(this)},_=function(e){if(r[i].sliderElements[e]!==void 0){var t=r[i].sliderElements[e].querySelector("[data-type]"),n=t.getAttribute("data-type");h[n].onPreload(t)}},j=function(e){if(r[i].sliderElements[e]!==void 0){var t=r[i].sliderElements[e].querySelector("[data-type]"),n=t.getAttribute("data-type");h[n].onLoad(t)}},T=function(e){r[i].currentIndex>0&&(Z(r[i].currentIndex),j(--r[i].currentIndex),I("left"),ee(r[i].currentIndex+1),_(r[i].currentIndex-1),e&&e.call(this))},O=function(e){r[i].currentIndex<r[i].elementsLength-1&&(Z(r[i].currentIndex),j(++r[i].currentIndex),I("right"),ee(r[i].currentIndex-1),_(r[i].currentIndex+1),e&&e.call(this))},Z=function(e){if(r[i].sliderElements[e]!==void 0){var t=r[i].sliderElements[e].querySelector("[data-type]"),n=t.getAttribute("data-type");h[n].onLeave(t)}},ee=function(e){if(r[i].sliderElements[e]!==void 0){var t=r[i].sliderElements[e].querySelector("[data-type]"),n=t.getAttribute("data-type");h[n].onCleanup(t)}},G=function(){i=i!==null?i:l,D=-r[i].currentIndex*d.offsetWidth,r[i].slider.style.transform="translate3d("+D+"px, 0, 0)",q=D},we=function(){b.textContent=r[i].currentIndex+1+"/"+r[i].elementsLength},Le=function(e){var t=null;o.nav?(c.disabled=!1,f.disabled=!1,e==="left"?c.focus():f.focus(),r[i].elementsLength===1?(c.disabled=!0,f.disabled=!0,o.close&&p.focus()):(r[i].currentIndex===0&&(c.disabled=!0,f.focus()),r[i].currentIndex===r[i].elementsLength-1&&(f.disabled=!0,c.focus()))):o.close&&p.focus(),t=d.querySelectorAll(".tobii > button:not(:disabled)"),N=t[0],H=t.length===1?t[0]:t[t.length-1]},U=function(){u={startX:0,endX:0,startY:0,endY:0}},te=function(){var e=u.endX-u.startX,t=u.endY-u.startY,n=Math.abs(e),s=Math.abs(t);e>0&&n>o.threshold&&r[i].currentIndex>0?T():e<0&&n>o.threshold&&r[i].currentIndex!==r[i].elementsLength-1?O():t<0&&s>o.threshold&&o.swipeClose?C():G()},re=function(){X||(X=!0,E.requestAnimationFrame(function(){G(),X=!1}))},ae=function(e){e.preventDefault(),i=z(this),Q(r[i].gallery.indexOf(this))},ie=function(e){e.target===c?T():e.target===f?O():(e.target===p||e.target.className==="tobii__slider-slide"&&o.docClose)&&C(),e.stopPropagation()},ne=function(e){e.keyCode===9||e.code==="Tab"?e.shiftKey?document.activeElement===N&&(H.focus(),e.preventDefault()):document.activeElement===H&&(N.focus(),e.preventDefault()):e.keyCode===27||e.code==="Escape"?(e.preventDefault(),C()):e.keyCode===37||e.code==="ArrowLeft"?(e.preventDefault(),T()):(e.keyCode===39||e.code==="ArrowRight")&&(e.preventDefault(),O())},oe=function(e){pe(e.target)||(e.stopPropagation(),y=!0,u.startX=e.touches[0].pageX,u.startY=e.touches[0].pageY,r[i].slider.classList.add("tobii__slider--is-dragging"))},de=function(e){e.stopPropagation(),y&&(e.preventDefault(),u.endX=e.touches[0].pageX,u.endY=e.touches[0].pageY,fe())},se=function(e){e.stopPropagation(),y=!1,r[i].slider.classList.remove("tobii__slider--is-dragging"),u.endX&&(x=!1,S=!1,te()),U()},ue=function(e){pe(e.target)||(e.preventDefault(),e.stopPropagation(),y=!0,u.startX=e.pageX,u.startY=e.pageY,r[i].slider.classList.add("tobii__slider--is-dragging"))},le=function(e){y&&(u.endX=e.pageX,u.endY=e.pageY,fe())},ce=function(e){e.stopPropagation(),y=!1,r[i].slider.classList.remove("tobii__slider--is-dragging"),u.endX&&(x=!1,S=!1,te()),U()},fe=function(){Math.abs(u.startX-u.endX)>0&&!S&&o.swipeClose?(r[i].slider.style.transform="translate3d("+(q-Math.round(u.startX-u.endX))+"px, 0, 0)",x=!0,S=!1):Math.abs(u.startY-u.endY)>0&&!x&&(r[i].slider.style.transform="translate3d("+q+"px, -"+Math.round(u.startY-u.endY)+"px, 0)",x=!1,S=!0)},Ee=function(){o.keyboard&&E.addEventListener("keydown",ne),E.addEventListener("resize",re),d.addEventListener("click",ie),o.draggable&&(F()&&(d.addEventListener("touchstart",oe),d.addEventListener("touchmove",de),d.addEventListener("touchend",se)),d.addEventListener("mousedown",ue),d.addEventListener("mouseup",ce),d.addEventListener("mousemove",le))},xe=function(){o.keyboard&&E.removeEventListener("keydown",ne),E.removeEventListener("resize",re),d.removeEventListener("click",ie),o.draggable&&(F()&&(d.removeEventListener("touchstart",oe),d.removeEventListener("touchmove",de),d.removeEventListener("touchend",se)),d.removeEventListener("mousedown",ue),d.removeEventListener("mouseup",ce),d.removeEventListener("mousemove",le))},V=function(e,t){return e.getAttribute("data-type")===t},Se=function(e){var t=e.querySelectorAll("src");t&&Array.prototype.forEach.call(t,function(n){n.setAttribute("src","")})},B=function(){o.draggable&&r[i].elementsLength>1&&!r[i].slider.classList.contains("tobii__slider--is-draggable")&&r[i].slider.classList.add("tobii__slider--is-draggable"),!o.nav||r[i].elementsLength===1||o.nav==="auto"&&F()?(c.setAttribute("aria-hidden","true"),f.setAttribute("aria-hidden","true")):(c.setAttribute("aria-hidden","false"),f.setAttribute("aria-hidden","false")),!o.counter||r[i].elementsLength===1?b.setAttribute("aria-hidden","true"):b.setAttribute("aria-hidden","false")},Ce=function(){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e].slider.style.display=i===e?"block":"none")},I=function(e){Ce(),G(),we(),Le(e)},Ie=function(e){m()&&C();var t=Object.entries(r);Array.prototype.forEach.call(t,function(n){var s=n[1].gallery;Array.prototype.forEach.call(s,function(v){$(v)})}),d.parentNode.removeChild(d),r={},l=i=null,k=0,e&&e.call(this)},m=function(){return d.getAttribute("aria-hidden")==="false"},F=function(){return"ontouchstart"in window},pe=function(e){return["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.nodeName)!==-1||e===c||e===f||e===p||r[i].elementsLength===1},_e=function(){return r[i].currentIndex},Te=function(){return i!==null?i:l},Oe=function(e){if(m())throw new Error("Ups, I can't do this. Tobii is open.");if(e){if(e&&!Object.prototype.hasOwnProperty.call(r,e))throw new Error("Ups, I don't have a group called \""+e+'".');i=e}};return ge(L),{open:Q,prev:T,next:O,close:C,add:J,remove:$,destroy:Ie,isOpen:m,currentSlide:_e,selectGroup:Oe,currentGroup:Te}}return w});
//# sourceMappingURL=/s/files/1/1154/4260/t/76/assets/lightbox.js.map?v=113989875802016127911655287002
