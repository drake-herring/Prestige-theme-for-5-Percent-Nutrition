[{%- assign position = 0 -%}{%- assign linksize = linklist.links | size -%}{%- comment %}<locksmith:021d>{% endcomment -%}{%- assign locksmith_ccea_forloop__size = 0 %}{% for link in linklist.links %}{% capture var %}{% render 'locksmith-variables', scope: 'subject', subject: link, subject_parent: linklist, variable: 'transparent' %}{% endcapture %}{% if var == 'true' %}{% assign locksmith_ccea_forloop__size = locksmith_ccea_forloop__size | plus: 1 %}{% endif %}{% endfor %}{% assign locksmith_ccea_forloop__index = nil -%}{%- comment %}</locksmith:021d>{% endcomment -%}{% for link in linklist.links %}{%- comment %}<locksmith:d67d>{% endcomment -%}{%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: link, subject_parent: linklist, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% if locksmith_ccea_forloop__index == nil %}{% assign locksmith_ccea_forloop__index = 1 %}{% assign locksmith_ccea_forloop__index0 = 0 %}{% else %}{% assign locksmith_ccea_forloop__index = locksmith_ccea_forloop__index | plus: 1 %}{% assign locksmith_ccea_forloop__index0 = locksmith_ccea_forloop__index0 | plus: 1 %}{% endif %}{% if locksmith_ccea_forloop__index == 1 %}{% assign locksmith_ccea_forloop__first = true %}{% else %}{% assign locksmith_ccea_forloop__first = false %}{% endif %}{% if locksmith_ccea_forloop__index == locksmith_ccea_forloop__size %}{% assign locksmith_ccea_forloop__last = true %}{% else %}{% assign locksmith_ccea_forloop__last = false %}{% endif %}{% assign locksmith_ccea_forloop__rindex = locksmith_ccea_forloop__size | minus: locksmith_ccea_forloop__index | minus: 1 %}{% assign locksmith_ccea_forloop__rindex0 = locksmith_ccea_forloop__size | minus: locksmith_ccea_forloop__index0 | minus: 1 %}{% else %}{% continue %}{% endif -%}{%- comment %}</locksmith:d67d>{% endcomment -%}{%- assign subject_id = link.url  -%}{%- assign subject_params = null  -%}{%- assign childrensize = link.links | size  -%}{% if link.type == "product_link" %}{%- assign subject_id = subject_id | replace: "/products/", "" -%}{% elsif link.type == "page_link" %}{%- assign subject_id = subject_id | replace: "/pages/", "" -%}{% elsif link.type == "blog_link" %}{%- assign subject_id = subject_id | replace: "/blogs/", "" -%}{% elsif link.type == "collection_link" %}{%- assign subject_id = subject_id | replace: "/collections/", "" -%}{%- assign params = subject_id | split: "/" -%}{% if params.size > 1 %}{%- assign subject_id = params.first -%}{%- assign subject_params = params.last | replace: "+", ", " -%}{% endif %}{% endif %}{%- assign position = position | plus: 1 -%}{"id": "{{ position }}","title": "{{ link.title | replace: '"', '\"' }}","subject": "{{ subject_id }}","subject_id": "{{ link.object.id }}","link_list_id": "{{ count }}","position": {{ position }},"subject_params": "{{ subject_params }}","link_type": "{{ link.type | replace: "_link", "" }}","levels": {{ link.levels }},"links": {% if childrensize > 0 %} {% include "motifmate-links", linklist: link, count: count %} {% else %} null {% endif %}}{% if locksmith_ccea_forloop__last != true %},{% endif %}{% endfor %}]